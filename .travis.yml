sudo: required
language: python
services:
- docker
env:
  global:
  - secure: LHpJX0QsgNGImCUZ4Eq+q8+xtTLKsdL7pf3YKzsWL6fBXifIIWVTWecVBzssUaBmA+aQogaXKdloY0Goc/7zkYEckQoARo6KEIvc49F07KxR5BDF0pNVUFEqMkNP8o5bNCLkafYYnBWPfCecBt2/AuGN/Zyq1gTitPg323ISfnmLTcJl7kp/yVtfA1NczBxtLdAsQCOj6qKGjHvoAfBNFxSJh3Cvxay+TFNk5eHzb7qQ5huFF3KvvwOi//CCtlU6DfQ/Bt62cXi8sDDByoVqSZKO3ydwjqZgqYKVvZSuck7cPi8T9eBsfttfkt1WphPJy4zf2o4iWuODh955gQyM1z/AQLRZgOiOJSq/lAiiGldJBa83pqxEpR7kBHyQh8yZLL4nCX5qm6j1wwsChnUf4+HaSgX7lSYKd9XcfeK7LdQ68uMMPMNrhzTxoc92VYvydoIABal/OwAGmfoXvoYFgL1uKfE9Z0vB0jkZxPiQkcxIlQA2QNdsQUyLGaLvLNN693s9Ov2JHlTzFo6ZOXzZQOXtSbcrENOaG9UMayr4UtWwujwcgVnaYnyccSeU/NH6MTkbedUeZHBVzv5GZU596OOzhQmB8fh57/0ERRR1EDVfgrmXu2+jgt7MJh983+DfdRG+PBeNIg2i8nMkFB939VDnjCrmGXhmJY3vVXvWojE=
  - secure: UpRjBMq+7pFe85TOGaQQmwgac6ccK4Oe1ihgUZgXZ5+XHjepVoL78WJ8iL8LY6d15QcyTPjy3TbffuvN9mKNSjAQeMAb8RixdUAyx2u4yXDb+H2Uc6wlhp44pabNdDUVTNb2vlOVov98s1PDLe9VuCvxUvOdjrxmmObNzgTKn8y1xxl96jUDSpH+QHTguX02b93Sp9y2zIr01DO1YoAR5yCqSQHWL/mGzYjqJBO2aEqOcIzTQjfWiTMlOu3JVW11esgAdkMLWx3QW6F4LC6vBGYEgtcjp6BTl7ShQHsC+HfWclEUxORCmkfXPRDu6LgQn0oXXzDs9OchzV8xRY6ijSvAB5BtuxfSpqJh2lnMU0e6f4STl3h3/CEx6vFVwmudY/bJWg5BqXgFsrkcVUWFBAw9g929/568TfyKK9sODbDZa7ZoCU2Gi67pZVshdJAK2SFRnGRe3BbJnSGg2byV9isY2TujaGM3wxVHdS7SbJtms0XoIHXyEvn0OufkzO71qs9Q5qbDsgvgyQ67y89yE8+xp6PvUlx4RNQGufhGYPumgi8xdOuk8l1+Vn18lH0aoLV3EhSk4AYE5q9xaPxILqTXcdFaX0mlJhihAPwfKdwQANaoqSZ5I7ZEnZYr67PDt8BsfbE0+2Zj7gMMxXYw7PNBwqhWfGqFSnsN/74axVw=
  - secure: taW81RHqnbG7/y81a/+8LK4xD5SQtRNpOOE0YqqCjcCOU+zWdsUxHzTH9mB1HxUdvaxfp/F1n0bWbwlCM6GkbOsF63axxlhTzi2IrtmPcrFG4kT2rP31e0GN/KXpht56NshvUDFwdtzDcktgnF9U2adtDBHnSuNaeSW+oanCMLCjoAneEhUhPr+97sKDdYQDtz2CzS7/LpV6SRedaoij45UbJYFE/lq7sKUtz1RNEnX6eDH7bB2ziEn+BUBBbWrAhcYG7Yk8nCRbhy7Qm9EoqkkUa8xLP91QS8X9jFFn6+y0xfgItK/V4bmXj4aoX1XRpD8DslA7ZBFUpro3DQ5RfnRNgAMYxUnp8qi78h/vMIThrU7EXAm2sD6CeL1dES233GG4Z3w0b8x4/x7gaNG43OcadaCblxAak3tA+3l3cmNcL/rde7+zIYE0mD6neSRKTzPR11BRXFOYqktsMx8P7OPVs9H116+vt5nJkusycEdd86PRVrIB7fcCVuudmP9EDoRDTZv2t5M4zaJbaZsGuBWFq9cL/5QBeLvvcuJN90SkTHmUfCzqAetpW6I38cmZ3/BY3pOIxuqcynVrZHkkFiNmRtnA9sfOYmjU8ew5/YUkVYTJ19oz65jL2Fm3ftBtP35mJck+bUYC+Yzl42oGZa6ScQjZBC1VdkZSWQEt35M=
python:
- '3.5'
install:
- pip install -r requirements.txt
script:
- python manage.py test
after_success:
- TRAVIS=False PROD=True python pointdistribution/manage.py makemigrations
- TRAVIS=False PROD=True python pointdistribution/manage.py migrate
- test $TRAVIS_BRANCH == "master" && docker login -u=discoveryregistry -p=/Qgk0+YPweZLKFiO+olW1/LNwCpl38Az
  discoveryregistry-on.azurecr.io & docker build -t discoveryregistry-on.azurecr.io/100point:$APP_MAJOR_VERSION.$APP_MINOR_VERSION.$TRAVIS_BUILD_NUMBER
  . && docker push discoveryregistry-on.azurecr.io/100point:$APP_MAJOR_VERSION.$APP_MINOR_VERSION.$TRAVIS_BUILD_NUMBER
